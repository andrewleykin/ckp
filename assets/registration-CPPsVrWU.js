const __vite__fileDeps=["assets/common-info-ir886jpB.js","assets/index-YL4AAcl0.js","assets/index-CSpIbD9y.css","assets/ui-input-phone-oXEF9li1.js","assets/ui-typography-Df9E3_dG.js","assets/ui-typography-C2SO__n3.css","assets/index-pxBI3MdA.js","assets/ui-icon-BRi8thUF.js","assets/ui-icon-D9llI2Q6.css","assets/ui-input-phone-BHwaDlmb.css","assets/common-info-Be_qWmLO.css","assets/accountable-info-Cks0uzP_.js","assets/accountable-info-DHK6huX5.css","assets/additional-info-C2F9rLeD.js","assets/additional-info-Dfm2dbEK.css","assets/payment-1G0rL0F5.js","assets/payment-CP_NGbl7.css","assets/manual-success-C2H6vHgg.js","assets/info-card-C0kIeEQ7.js","assets/ui-card-BzH1-Ui7.js","assets/ui-card-B5JhhpIO.css","assets/info-card-ClOMh4Yv.css","assets/ui-success-B8uUqBvB.js","assets/ui-success-BLpnxn46.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as A,m as N,o as v,h as T,w as i,a as h,b as n,f,u as e,t as E,p as R,k as H,g as k,n as O,c as C,F as M,e as z,q as L,s as Q,C as S,v as P,x,P as F,y as $,z as W,A as J,B as X,_ as V,i as D,j as G,D as Z,E as ee}from"./index-YL4AAcl0.js";import{D as te,a as ae,A as Y,P as se,b as w}from"./index-pxBI3MdA.js";import{P as re}from"./payment-block-ByWjG6UD.js";import{U as oe}from"./ui-card-BzH1-Ui7.js";import{U as y,_ as B}from"./ui-typography-Df9E3_dG.js";import{U as q}from"./ui-icon-BRi8thUF.js";import{I as ne,a as le}from"./icc-input-BRIejGFu.js";import{U as ie,_ as ce}from"./ui-input-phone-oXEF9li1.js";const ue=(s,c=" ")=>s.toString().replaceAll(/\B(?=(\d{3})+(?!\d))/g,c),j=s=>(R("data-v-1e0431e0"),s=s(),H(),s),de={class:"item"},pe=j(()=>h("span",{class:"divider"},null,-1)),me={class:"item"},_e=j(()=>h("span",{class:"divider"},null,-1)),ve={class:"item"},fe=A({__name:"price-card",props:{count:{}},setup(s){const c=s,l=N(()=>`${ue(c.count*te)} рублей`),g=N(()=>`${ae} месяцев`);return(r,t)=>(v(),T(e(oe),{class:"price-card"},{default:i(()=>[h("div",de,[n(e(y),{variant:"Body5",color:"gray"},{default:i(()=>[f(" Кол-во SIM ")]),_:1}),n(e(y),{variant:"Body2",color:"black"},{default:i(()=>[f(E(c.count),1)]),_:1})]),pe,h("div",me,[n(e(y),{variant:"Body5",color:"gray"},{default:i(()=>[f(" Итоговая стоимость ")]),_:1}),n(e(y),{variant:"Body2",color:"black"},{default:i(()=>[f(E(l.value),1)]),_:1})]),_e,h("div",ve,[n(e(y),{variant:"Body5",color:"gray"},{default:i(()=>[f(" Срок оказания услуг ")]),_:1}),n(e(y),{variant:"Body2",color:"black"},{default:i(()=>[f(E(g.value),1)]),_:1})])]),_:1}))}}),ye=B(fe,[["__scopeId","data-v-1e0431e0"]]),ge=["onClick"],he={class:"step-count"},ke=A({__name:"ui-steps",props:{steps:{},currentStep:{default:0},isChangeable:{type:Boolean,default:!0}},emits:["update:currentStep"],setup(s,{emit:c}){const l=s,g=c,r=k(l.currentStep),t=a=>a<r.value?"done":a===r.value?"active":"rest",p=N(()=>l.steps.map((a,m)=>({...a,status:t(m)}))),d=a=>{l.isChangeable&&(r.value=a,g("update:currentStep",a))},U=a=>({done:"additional-green",active:"black",rest:"light-gray"})[t(a)],I=a=>({done:"additional-green",active:"black",rest:"light-gray"})[t(a)];return O(()=>l.currentStep,a=>{r.value=a}),(a,m)=>(v(),C("div",{class:L(["ui-steps",{changeable:a.isChangeable}])},[(v(!0),C(M,null,z(p.value,(_,o)=>(v(),C("div",{key:_.key??`step-${o}`,class:L(["step",`step-${_.status}`]),onClick:u=>d(o)},[h("span",he,[_.status==="done"?(v(),T(e(q),{key:0,name:"checkmark-circle",size:"34px",class:"ready-icon",color:"additional-green"})):(v(),T(e(y),{key:1,variant:"Body3",class:"step-count-text",color:U(o)},{default:i(()=>[f(E(o+1),1)]),_:2},1032,["color"]))]),n(e(y),{component:"span",variant:"Body5",class:"step-text",color:I(o)},{default:i(()=>[f(E(_.text),1)]),_:2},1032,["color"])],10,ge))),128))],2))}}),be=B(ke,[["__scopeId","data-v-6a7cbdf3"]]),Se={key:0,class:"header"},Ce=A({__name:"client-info-enter",props:{partner:{},simcards:{}},setup(s){const c=s,{notify:l}=G(),g=k(!1),r=k(""),t=k({simcards:[],client:{name:"",bossName:"",accountableName:"",accountablePhoneNumber:"",email:"",inn:"",kpp:"",address:""},salesman:""}),p=N(()=>Q(c.partner.defaultPaymentType)),d=k(p.value[0]),U=N(()=>({[S.COMMON_INFO]:P(x(()=>V(()=>import("./common-info-ir886jpB.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])))),[S.ACCOUNTABLE_INFO]:P(x(()=>V(()=>import("./accountable-info-Cks0uzP_.js"),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9,12])))),[S.ADDITIONAL_INFO]:P(x(()=>V(()=>import("./additional-info-C2F9rLeD.js"),__vite__mapDeps([13,1,2,3,4,5,6,7,8,9,14])))),[S.PAYMENT]:P(x(()=>V(()=>import("./payment-1G0rL0F5.js"),__vite__mapDeps([15,4,1,2,5,16])))),[S.MANUAL_SUCCESS]:P(x(()=>V(()=>import("./manual-success-C2H6vHgg.js"),__vite__mapDeps([17,18,6,1,2,19,4,5,20,21,22,7,8,23]))))})[d.value]),I=N(()=>c.partner.defaultPaymentType===F.TINKOFF_ACQUIRING),a=N(()=>c.partner.defaultPaymentType===F.MANUAL),m=async()=>{g.value=!0;try{const{data:{shipmentIds:o}}=await D.simcard.register(t.value);if(I.value){const{data:{paymentURL:u}}=await D.tinkoffPayment.payTinkoff({shipmentIds:o});r.value=u??"",d.value=S.PAYMENT;return}if(a.value){await D.manualPayment.payManually({shipmentIds:o}),d.value=S.MANUAL_SUCCESS;return}}catch(o){o instanceof Y&&l({title:"Произошла ошибка",text:o.message,type:"error"})}finally{g.value=!1}},_=async()=>{if(!(d.value>p.value.length-1)){if(d.value===S.ADDITIONAL_INFO){await m();return}d.value=p.value[d.value+1]}};return O(()=>c.simcards,()=>{t.value.simcards=c.simcards},{immediate:!0,deep:!0}),(o,u)=>(v(),C(M,null,[d.value!==e(S).MANUAL_SUCCESS?(v(),C("div",Se,[n(e(be),{"current-step":d.value,"onUpdate:currentStep":u[0]||(u[0]=b=>d.value=b),steps:e(X)(p.value),"is-changeable":!1,class:L(["steps",{"is-tinkoff":I.value}])},null,8,["current-step","steps","class"])])):$("",!0),(v(),T(J(U.value),{client:t.value.client,"onUpdate:client":u[1]||(u[1]=b=>t.value.client=b),salesman:t.value.salesman,"onUpdate:salesman":u[2]||(u[2]=b=>t.value.salesman=b),partner:o.partner,"is-loading":g.value,onNextStep:_},W({_:2},[I.value?{name:"price-card",fn:i(()=>[n(e(ye),{class:"price-card",count:t.value.simcards.length},null,8,["count"])]),key:"0"}:void 0,I.value&&d.value===e(S).PAYMENT?{name:"payment-block",fn:i(()=>[r.value?(v(),T(e(re),{key:0,"payment-url":r.value},null,8,["payment-url"])):$("",!0)]),key:"1"}:void 0]),1064,["client","salesman","partner","is-loading"]))],64))}}),Ie=B(Ce,[["__scopeId","data-v-c8505951"]]),Te="/assets/card-DacGkOc4.png",Ne=["disabled","checked"],Ee=A({inheritAttrs:!1,__name:"ui-checkbox",props:{modelValue:{type:Boolean},isDisabled:{type:Boolean},isError:{type:Boolean}},emits:["update:modelValue"],setup(s,{emit:c}){const l=s,g=c,r=k(l.modelValue),t=p=>{const d=p.target.checked;r.value=d,g("update:modelValue",d)};return O(()=>l.modelValue,p=>{r.value=p}),(p,d)=>(v(),C("label",{class:L(["ui-checkbox",[{"is-checked":r.value},{"is-disabled":l.isDisabled},{"is-error":l.isError},p.$attrs.class]])},[h("input",Z({type:"checkbox",disabled:l.isDisabled,checked:r.value},p.$attrs,{"data-test-id":"ui-checkbox__input",onChange:t}),null,16,Ne),n(e(y),{variant:"Body4"},{default:i(()=>[ee(p.$slots,"default",{},void 0,!0)]),_:3})],2))}}),Ae=B(Ee,[["__scopeId","data-v-0ebef531"]]),Be=s=>({simNumber:s.simNumber,iccLastFourDigits:s.iccLastFourDigits}),Ue=s=>(R("data-v-d52faabe"),s=s(),H(),s),Pe={class:"simcards-enter"},xe={class:"group"},Ve={class:"phone-list"},De={class:"phone-block"},Le=Ue(()=>h("div",{class:"image-card"},[h("img",{src:Te,alt:"Изображение SIM карты"})],-1)),$e=A({__name:"simcards-enter",emits:["update:partner","update:simcards"],setup(s,{emit:c}){const l=c,{notify:g}=G(),r=k(!1),t=k([{id:0,simNumber:"",iccLastFourDigits:""}]),p=k(!1),d=()=>{var a;t.value.push({id:(((a=t.value.at(-1))==null?void 0:a.id)??0)+1,simNumber:"",iccLastFourDigits:""})},U=a=>{t.value=t.value.filter(m=>m.id!==a)},I=async()=>{var a;r.value=!0;try{const m=t.value.map(Be);if(!m.every(({simNumber:u,iccLastFourDigits:b})=>u.length===se||b)){g({title:"Некорректные данные",type:"warn"});return}if(!p.value){g({title:"Вы должны согласиться с условиями предоставления услуг",type:"warn"});return}const{data:o}=await D.simcard.validateSim({simcards:m});if(!o.valid){o.error&&g({title:"Произошла ошибка",text:o.error,type:"error"}),(a=o.simcardErrors)==null||a.forEach(u=>{const b=t.value.find(K=>K.simNumber===u.simNumber);b&&(b.errorText=u.reason)});return}l("update:partner",o.partner),l("update:simcards",m)}catch(m){m instanceof Y&&g({title:"Произошла ошибка",text:m.message,type:"error"})}finally{r.value=!1}};return(a,m)=>(v(),C("div",Pe,[n(e(y),{variant:"HeadlineH3",class:"mb-24"},{default:i(()=>[f(" Заполнение данных SIM карт ")]),_:1}),h("div",xe,[h("div",Ve,[h("div",De,[n(e(y),{variant:"Body5",color:"gray"},{default:i(()=>[f(" № ")]),_:1}),n(e(y),{variant:"Body5",color:"gray"},{default:i(()=>[f(" Номер телефона ")]),_:1}),n(e(y),{variant:"Body5",color:"gray"},{default:i(()=>[n(e(ne))]),_:1})]),(v(!0),C(M,null,z(t.value,(_,o)=>(v(),C("div",{key:_.id,class:"phone-block"},[n(e(y),{variant:"Body4",color:"black"},{default:i(()=>[f(E(o+1),1)]),_:2},1024),n(e(ie),{modelValue:_.simNumber,"onUpdate:modelValue":[u=>_.simNumber=u,u=>_.errorText=""],"error-text":_.errorText},null,8,["modelValue","onUpdate:modelValue","error-text"]),n(e(le),{modelValue:_.iccLastFourDigits,"onUpdate:modelValue":u=>_.iccLastFourDigits=u,"is-show-label":!1},null,8,["modelValue","onUpdate:modelValue"]),t.value.length>1?(v(),T(e(q),{key:0,class:"delete-phone",name:"close",color:"black",size:"24px",onClick:u=>U(_.id)},null,8,["onClick"])):$("",!0)]))),128)),n(e(y),{class:"add-phone",variant:"Body5",color:"additional-dark-blue",onClick:d},{default:i(()=>[f(" + Добавить номер ")]),_:1})]),Le]),n(e(Ae),{modelValue:p.value,"onUpdate:modelValue":m[0]||(m[0]=_=>p.value=_),class:"checkbox mb-32"},{default:i(()=>[f(" Вы даёте подтверждение, что ознакомлены с условиями предоставления услуг ("),n(e(y),{variant:"Body4",color:"additional-blue",component:"a",href:e(w),target:"_blank",rel:"noopener noreferrer"},{default:i(()=>[f(E(e(w)),1)]),_:1},8,["href"]),f("). ")]),_:1},8,["modelValue"]),n(e(ce),{onClick:I},{default:i(()=>[f("Продолжить")]),_:1})]))}}),Oe=B($e,[["__scopeId","data-v-d52faabe"]]),Me={class:"registration"},Fe=A({__name:"registration",setup(s){const c=k([]),l=k();return(g,r)=>(v(),C("main",Me,[l.value&&c.value.length?(v(),T(Ie,{key:0,partner:l.value,simcards:c.value},null,8,["partner","simcards"])):(v(),T(Oe,{key:1,"onUpdate:partner":r[0]||(r[0]=t=>l.value=t),"onUpdate:simcards":r[1]||(r[1]=t=>c.value=t)}))]))}}),Ke=B(Fe,[["__scopeId","data-v-28d68288"]]);export{Ke as default};
